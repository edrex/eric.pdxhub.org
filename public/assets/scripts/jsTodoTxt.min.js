/*!
 * jsTodoTxt Library v0.3.0
 * https://github.com/jmhobbs/jsTodoTxt
 *
 * Copyright 2011, John Hobbs
 * Licensed under the MIT license.
 * https://github.com/jmhobbs/jsTodoTxt/blob/master/LICENSE
 */
var TodoTxt={_trim_re:/^\s+|\s+$/g,_complete_re:/^x\s([0-9]{4}-[0-9]{1,2}-[0-9]{1,2})\s+/i,_complete_replace_re:/^x\s([0-9]{4}-[0-9]{1,2}-[0-9]{1,2})\s+/i,_date_re:/^([0-9]{4}-[0-9]{1,2}-[0-9]{1,2})/,_date_replace_re:/^[0-9]{4}-[0-9]{1,2}-[0-9]{1,2}\s*/,_priority_re:/^\(([A-Z])\)/,_priority_replace_re:/^\([A-Z]\)\s*/,_context_re:/@(\S+)/g,_context_replace_re:/\s*@\S+\s*/g,_project_re:/\+(\S+)/g,_project_replace_re:/\s*\+\S+\s*/g,parse:function(d){var b=[];var a=d.split("\n");for(i in a){try{b.push(new TodoTxtItem(a[i]))}catch(c){}}return b},parseLine:function(a){return new TodoTxtItem(a)},render:function(b){var a=[];for(i in b){a.push(b[i].toString())}return a.join("\n")},renderItem:function(a){return a.toString()}};function TodoTxtItem(a){this.reset=function(){this.text=null;this.priority=null;this.complete=false;this.completed=null;this.date=null;this.contexts=null;this.projects=null};this.dateString=function(){if(this.date){return this.date.getFullYear()+"-"+((this.date.getMonth()+1<10)?"0":"")+(this.date.getMonth()+1)+"-"+((this.date.getDate()<10)?"0":"")+this.date.getDate()}else{return null}};this.completedString=function(){if(this.completed){return this.completed.getFullYear()+"-"+((this.completed.getMonth()+1<10)?"0":"")+(this.completed.getMonth()+1)+"-"+((this.completed.getDate()<10)?"0":"")+this.completed.getDate()}else{return null}};this.toString=function(){var b=this.text;if(null!=this.date){b=this.dateString()+" "+b}if(null!=this.priority){b="("+this.priority+") "+b}if(this.complete&&null!=this.completed){b="x "+this.completedString()+" "+b}if(null!=this.projects){b=b+" +"+this.projects.join(" +")}if(null!=this.contexts){b=b+" @"+this.contexts.join(" @")}return b};this.parse=function(c){this.reset();c=c.replace(TodoTxt._trim_re,"");c=c.replace("\r","");var b=TodoTxt._complete_re.exec(c);if(null!=b){this.complete=true;this.completed=new Date(Date.parse(b[1]));c=c.replace(TodoTxt._complete_replace_re,"")}var f=TodoTxt._priority_re.exec(c);if(null!=f){this.priority=f[1];c=c.replace(TodoTxt._priority_replace_re,"")}var d=TodoTxt._date_re.exec(c);if(null!=d){this.date=new Date(Date.parse(d[1]));c=c.replace(TodoTxt._date_replace_re,"")}var g=c.match(TodoTxt._context_re);if(null!=g){this.contexts=[];for(i in g){this.contexts.push(g[i].substr(1))}c=c.replace(TodoTxt._context_replace_re," ")}var e=c.match(TodoTxt._project_re);if(null!=e){this.projects=[];for(i in e){this.projects.push(e[i].substr(1))}c=c.replace(TodoTxt._project_replace_re," ")}c=c.replace(TodoTxt._trim_re,"");this.text=c;if(""==this.text){throw new Exception("Empty Task")}};if("string"==typeof(a)){this.parse(a)}else{this.reset()}};
