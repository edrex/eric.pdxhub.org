<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta http-equiv="CACHE-CONTROL" content="NO-CACHE"><title>Beaglebone Storage Server</title><meta name="viewport" content="width=device-width"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="stylesheet" href="/assets/styles/normalize.css"><link rel="stylesheet" href="/assets/styles/markdown.css"><link rel="stylesheet" href="/assets/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/assets/styles/style.css"><link rel="stylesheet" href="/assets/styles/highlight_solarized_dark.css"><meta name="google-site-verification" content="jdNxQ0D7Pu5Zp7em_fWgy3CMhDdvHL9R5aRt8HuL8KY"><script>var gaProperty = 'UA-342641-5';
if (document.cookie.indexOf("analytics-opt-out" + '=true') == -1) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', gaProperty, 'pdxhub.org');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
}</script></head><body><div class="container"><div class="header"><a href="/" title="Back to Eric's homepage" class="index">◀︎<i class="fa fa-coffee "></i></a> <h1 class="title"><span class="brand"> Beaglebone Storage Server </span></h1><h3 class="subheading">Build log for my home Camlistore</h3><div class="gather"><span data-raw="2014-04-20" class="date">Apr 19, 2014</span> <a href="/tags#camlistore" class="tag label label-default"><i class="fa fa-tag "></i>camlistore</a><a href="/tags#devices" class="tag label label-default"><i class="fa fa-tag "></i>devices</a></div></div><div class="cols"><div class="maincol"><div class="main"><h2>install debian</h2><p>My Beaglebone (shipped March 15) came stock with Angstrom, which I replaced with the official BB Debian image. Beaglebones are now shipping with Debian preinstalled.</p>
<ul>
<li><a href="http://beagleboard.org/latest-images">http://beagleboard.org/latest-images</a></li>
<li><a href="http://learn.adafruit.com/downloads/pdf/beaglebone-black-installing-operating-systems.pdf">http://learn.adafruit.com/downloads/pdf/beaglebone-black-installing-operating-systems.pdf</a></li>
</ul>
<h2>trim down</h2><p>The Beaglebone Debian image comes with a bunch of useful stuff (Git, tmux) but it only leaves about 120MB for installing application packages, log files, etc.</p>
<p>To see a list of manually installed packages sorted by size, open <code>aptitude</code> and</p>
<ul>
<li>Views &gt; new flat package list</li>
<li>limit (press <strong>l</strong>): !~v ~i !~M</li>
<li>sort (press <strong>S</strong>): installsize</li>
</ul>
<p>list of possibly unnecessary packages:</p>
<ul>
<li>/opt/cloud9 (not from a deb package) ~60MB</li>
</ul>
<h2>secure login</h2><ul>
<li>adduser, put in sudo group</li>
<li>disable root SSH login</li>
</ul>
<h2>hdd reformat</h2><ul>
<li>backup everything</li>
<li>GPT + btrfs</li>
<li>also looked at ZFS which has Mac support, but there were no ARM binaries and I read things about its cache being memory hungry. Investigate further if you want Mac support.</li>
</ul>
<h2>home network</h2><p>My home router is DD-WRT. I highly recommend using it over stock vendor firmwares.</p>
<ul>
<li>edit /etc/hostname to &quot;alexandria&quot;</li>
<li>dd-wrt: <ul>
<li>give the host a static IP and hostname via DHCP mac binding</li>
</ul>
</li>
<li><strong>Updated 4/28:</strong> In <em>Services &gt; DHCP Server</em> set the LAN Domain. This will resolve your host to the local IP for devices connected to your home network. For example, my public server is <em>alexandria.pdxhub.org</em>, so I set <em>pdxhub.org</em> as LAN domain.</li>
<li>forward ports to device: <code>3179</code>, <code>22</code></li>
</ul>
<h2>public network</h2><ul>
<li><a href="http://www.dd-wrt.com/wiki/index.php/Dynamic_DNS#freedns.afraid.org">Set up a dynamic DNS name using freedns.afraid.org</a></li>
<li>In the public DNS for your domain, CNAME the device subdomain to the dynamic domain.</li>
<li>Get a free SSL cert from StartSSL. <em>Thanks <a href="http://bret.io/">bret.io</a> for this tip!</em></li>
</ul>
<h2>cross-compile camlistore (on laptop)</h2><ul>
<li><code>git clone ...</code></li>
<li><code>cd /usr/local/go/src</code> (or wherever your Go source is)</li>
<li><code>sudo GOOS=linux GOARCH=arm CGO_ENABLED=0 ./make.bash --no-clean</code></li>
<li>src: <a href="http://stackoverflow.com/questions/12168873/cross-compile-go-on-osx">http://stackoverflow.com/questions/12168873/cross-compile-go-on-osx</a></li>
<li><code>go run make.go -arch=arm -os=linux</code></li>
<li>one line deploy: <code>go run make.go -arch=arm -os=linux &amp;&amp; rsync -avz bin/linux_arm/camlistored $USER@$HOST:/usr/local/bin/</code></li>
</ul>
<h2>camlistored startup</h2><ul>
<li>If you can, use systemd. Otherwise, <a href="https://gist.github.com/edrex/eab2fe86fba89346d4e1">here is the sysvinit script I used</a></li>
</ul>
<h2>syncc</h2><h2>Upcoming</h2><ul>
<li>case</li>
<li>usb power solution</li>
</ul></div></div><div class="sidebar"></div></div><div class="footer"></div></div><script src="/assets/scripts/jquery.min.js"></script><script src="/assets/scripts/lodash.min.js"></script><script src="/assets/scripts/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script><script src="/assets/scripts/toggle-grid.js"></script><script async defer src="https://hypothes.is/embed.js"></script></body></html>